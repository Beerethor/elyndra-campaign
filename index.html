<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elyndra ‚Äì L'Ultima Spedizione</title>
    <style>
        
        :root {
            /* ... le tue variabili esistenti ... */
        }

        /* INCOLLALO QUI SOTTO */
        .auth-btn {
            padding: 10px 20px;
            background: transparent;
            border: 1px solid var(--gold);
            color: var(--gold);
            cursor: pointer;
            font-weight: bold;
            text-transform: uppercase;
            transition: 0.3s;
        }
        .auth-btn:hover { background: var(--gold); color: black; }
        .hidden { display: none !important; }
        
        * { box-sizing: border-box; }
        body {
            margin: 0; padding: 0;
            font-family: 'Georgia', serif;
            background: #05070a;
            color: #e0e0e0;
            display: flex; flex-direction: column;
            min-height: 100vh; overflow-x: hidden;
        }

        /* ANIMAZIONE GLITCH / LITOSTASI */
        @keyframes litostasi-glitch {
            0% { text-shadow: 2px 0 #555, -2px 0 #888; transform: skew(0deg); }
            20% { text-shadow: -2px 0 #c9a24d, 2px 0 #444; transform: skew(0.8deg); }
            40% { text-shadow: 2px 0 #333, -2px 0 #c9a24d; transform: skew(-0.8deg); }
            60% { text-shadow: -1px 0 #666, 1px 0 #222; transform: skew(0deg); }
            80% { text-shadow: 2px 0 #c9a24d, -2px 0 #888; transform: skew(0.3deg); }
            100% { text-shadow: -2px 0 #777, 2px 0 #444; transform: skew(0deg); }
        }

        /* Hero Section */
        .hero {
            position: relative;
            height: 100vh;
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            text-align: center;
            background: linear-gradient(rgba(5, 7, 10, 0.6), rgba(5, 7, 10, 0.9)), 
                        url('img/sfondo-elyndra.png') center/cover no-repeat;
            border-bottom: 2px solid #c9a24d;
        }

        .hero h1 {
            font-size: 5rem; margin: 0;
            text-transform: uppercase;
            letter-spacing: 12px;
            animation: litostasi-glitch 5s infinite;
            color: #fff;
        }

        .hero p {
            font-size: 1.2rem; color: #c9a24d;
            max-width: 650px; margin: 25px auto;
            font-: italic; letter-spacing: 2px;
            line-height: 1.6;
        }

        /* GRIGLIA NAVIGAZIONE */
        .nav-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px; max-width: 1000px;
            width: 90%; margin-top: 40px;
        }

        .nav-card {
            background: rgba(20, 25, 35, 0.85);
            border: 1px solid rgba(201, 162, 77, 0.2);
            padding: 35px; 
            text-decoration: none;
            color: #fff; 
            transition: 0.3s ease;
            text-align: center; 
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        /* Effetto Hover */
        .nav-card:hover {
            border-color: #c9a24d;
            background: rgba(201, 162, 77, 0.1);
            transform: translateY(-5px);
        }

        .nav-card:hover h2 {
            animation: litostasi-glitch 0.3s infinite;
            color: #fff;
        }

        .nav-card h2 { 
            margin: 0; font-size: 1.5rem; 
            text-transform: uppercase; letter-spacing: 2px; 
            color: #c9a24d; transition: 0.3s;
        }

        .nav-card p { 
            font-size: 0.9rem; color: #aaa; 
            margin-top: 12px; line-height: 1.4;
        }

        /* Tasto Master Speciale */
        .master-card {
            border-color: rgba(255, 77, 77, 0.3);
        }
        .master-card:hover {
            border-color: #ff4d4d;
            background: rgba(255, 77, 77, 0.1);
        }
        .master-card h2 { color: #ff4d4d; }

        footer { padding: 40px; text-align: center; font-size: 0.75rem; color: #444; letter-spacing: 2px; }

        @media (max-width: 768px) {
            .hero h1 { font-size: 3rem; letter-spacing: 6px; }
            .nav-grid { grid-template-columns: 1fr; }
        }
        /* DOPPIO LIVELLO DI NEBBIA */
.fog-wrapper {
    position: absolute;
    top: 0; left: 0; width: 100%; height: 100%;
    overflow: hidden;
    z-index: 1;
    pointer-events: none;
}

.fog-layer-1, .fog-layer-2 {
    position: absolute;
    top: 0; left: 0; width: 200%; height: 100%;
    background: url('img/nebbia.png') repeat-x; 
    background-size: contain; /* O 'cover' a seconda della tua immagine */
    opacity: 0.2;
}

/* Nebbia lenta e profonda */
.fog-layer-1 {
    animation: move-fog 80s linear infinite;
    filter: blur(2px);
}

/* Nebbia pi√π veloce e superficiale */
.fog-layer-2 {
    animation: move-fog 45s linear infinite;
    opacity: 0.15;
}

@keyframes move-fog {
    from { transform: translateX(0); }
    to { transform: translateX(-50%); }
}

/* Contenuti sopra la nebbia */
.hero h1, .hero p, .nav-grid { position: relative; z-index: 10; }
.hero h1, .hero p, .nav-grid { position: relative; z-index: 10; }
    </style>
</head>
<body>

<div id="auth-section" style="text-align: right; padding: 20px;">
    <div id="logged-out-ui">
        <button class="auth-btn" onclick="loginGoogle()">Entra con Google</button>
        <button class="auth-btn" onclick="toggleEmailLogin()">Login Email</button>
    </div>
    
    <div id="logged-in-ui" class="hidden">
        <span id="user-info" style="color: var(--gold); margin-right: 15px;"></span>
        <button class="auth-btn" onclick="logout()">Esci</button>
    </div>
</div>

<div id="master-link-container" class="hidden" style="text-align: center; margin-top: 50px;">
    <a href="master.html" class="auth-btn" style="text-decoration: none; padding: 20px 40px; font-size: 1.2rem;">
        üëÅÔ∏è Accedi all'Archivio del Master
    </a>
</div>

<div id="email-modal" class="hidden" style="position:fixed; top:50%; left:50%; transform:translate(-50%, -50%); background: #111; border: 1px solid var(--gold); padding: 20px; z-index: 1000;">
    <input type="email" id="email" placeholder="Email" style="display:block; margin-bottom:10px; padding:8px;">
    <input type="password" id="password" placeholder="Password" style="display:block; margin-bottom:10px; padding:8px;">
    <button onclick="signUpEmail()" style="background: var(--gold); border:none; padding: 5px 10px; cursor:pointer;">Registrati</button>
    <button onclick="signInEmail()" style="background: var(--gold); border:none; padding: 5px 10px; cursor:pointer; margin-left: 5px;">Accedi</button>
    <button onclick="toggleEmailLogin()" style="background: transparent; color: white; border:none; margin-left: 10px; cursor:pointer;">Chiudi</button>
</div>
    
    <div id="player" style="display:none;"></div>

    <section class="hero">
    <div class="fog-wrapper">
        <div class="fog-layer-1"></div>
        <div class="fog-layer-2"></div>
    </div>
        <h1>ELYNDRA</h1>
        <p>"Mentre il mondo si ferma in un eterno silenzio di pietra, noi siamo il battito che ancora risuona."</p>

        <div class="nav-grid">
            <a href="wiki.html" class="nav-card">
                <h2>L'Archivio</h2>
                <p>Fazioni, leader e i segreti della Litostasi.</p>
            </a>

            <a href="diario.html" class="nav-card">
                <h2>Diario di Lyra</h2>
                <p>Memorie frammentate dai moli di Porto Althamar.</p>
            </a>

            <a href="master.html" class="nav-card master-card">
                <h2>Schermo Master</h2>
                <p>Accesso riservato al Narratore. Segreti e Meccaniche.</p>
            </a>
        </div>
    </section>

    <footer>
        ARCHIVIO DELLE VOCI IMMOBILI &copy; 2026 ‚Ä¢ ELYNDRA NON DIMENTICA
    </footer>

    <script>
    // Carica l'API di YouTube in modo asincrono
    var tag = document.createElement('script');
    tag.src = "https://www.youtube.com/iframe_api";
    var firstScriptTag = document.getElementsByTagName('script')[0];
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

    var player;
    function onYouTubeIframeAPIReady() {
        player = new YT.Player('player', {
            height: '0',
            width: '0',
            videoId: '6fp81GzKarQ', // ID del video di To Zanarkand
            playerVars: {
                'autoplay': 1,
                'loop': 1,
                'playlist': '6fp81GzKarQ', // Necessario per il loop
                'controls': 0,
                'showinfo': 0,
                'autohide': 1,
                'modestbranding': 1,
                'mute': 0 // Iniziamo senza muto, ma il browser potrebbe bloccarlo
            },
            events: {
                'onReady': onPlayerReady
            }
        });
    }

    function onPlayerReady(event) {
        // Funzione per far partire l'audio al primo click sulla pagina
        document.body.addEventListener('click', function() {
            player.playVideo();
        }, { once: true }); // Si attiva solo una volta
    }
</script>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { 
    getAuth, 
    signInWithPopup, 
    GoogleAuthProvider, 
    onAuthStateChanged, 
    signOut,
    createUserWithEmailAndPassword,
    signInWithEmailAndPassword,
    sendEmailVerification 
  } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBxwbmUT7efDSF5K2FT-JICRb59_letUS0",
    authDomain: "elyndra-6be99.firebaseapp.com",
    projectId: "elyndra-6be99",
    storageBucket: "elyndra-6be99.firebasestorage.app",
    messagingSenderId: "1062810114473",
    appId: "1:1062810114473:web:3abf8900d4513c132f0cb8"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const provider = new GoogleAuthProvider();

  // --- CONTROLLO STATO UTENTE ---
  onAuthStateChanged(auth, (user) => {
    const loggedOutUI = document.getElementById('logged-out-ui');
    const loggedInUI = document.getElementById('logged-in-ui');
    const masterLink = document.getElementById('master-link-container');
    const userInfo = document.getElementById('user-info');

    if (user) {
      // Se loggato
      loggedOutUI.classList.add('hidden');
      loggedInUI.classList.remove('hidden');
      userInfo.innerText = `Benvenuto, ${user.displayName || user.email}`;
      
      // MOSTRA LA CONSOLE SOLO SE SEI TU (Inserisci la tua mail qui)
      if (user.email === "tua-email-da-master@gmail.com") {
         masterLink.classList.remove('hidden');
      }
    } else {
      // Se disconnesso
      loggedOutUI.classList.remove('hidden');
      loggedInUI.classList.add('hidden');
      masterLink.classList.add('hidden');
    }
  });

  // --- FUNZIONI ---
  window.loginGoogle = () => signInWithPopup(auth, provider);
  window.logout = () => signOut(auth);
  window.toggleEmailLogin = () => document.getElementById('email-modal').classList.toggle('hidden');

  window.signUpEmail = async () => {
    const email = document.getElementById('email').value;
    const pass = document.getElementById('password').value;
    try {
      const cred = await createUserWithEmailAndPassword(auth, email, pass);
      await sendEmailVerification(cred.user);
      alert("Mail di conferma inviata! Controlla la tua casella.");
    } catch (e) { alert(e.message); }
  };

  window.signInEmail = () => {
    const email = document.getElementById('email').value;
    const pass = document.getElementById('password').value;
    signInWithEmailAndPassword(auth, email, pass).catch(e => alert(e.message));
  };
</script>
    
</body>
</html>


